EGachine <http://egachine.berlios.de>

is an open source  (GPL)  ECMAScript (JavaScript) game  machine/engine
using mozilla's JavaScript engine,  Spidermonkey.  Though the focus is
on 2D multi-player (networked)  games, EGachine isn't limited to games
at all.  You can think of  EGachine as a programmable OpenGL terminal,
which could be used in various ways - for example as presentation tool
or movie player similar to Flash, for teaching and learning OpenGL, as
special purpose terminal,...  .   Technically speaking  EGachine  is a
JavaScript interpreter with bindings for subsets of: OpenGL/MESA, SDL,
SDL_mixer, SDL_image and ZLib.

Perhaps a better name would have been pglTerm (for programmable opengl
terminal) but then  again this would suggest it  is somehow related to
xterm and other terminal emulation programs.

----------------------------------------------------------------------

WARNING:

THIS SOFTWARE COMES WITHOUT ANY WARRANTY
PERHAPS IT DESTROYS YOUR COMPUTER

FOR DETAILS SEE COPYING

THIS IS WORK IN PROGRESS (ALPHA)
THE SERVER AND CLIENT ARE INSECURE !
(see also TODO)

For now you should treat scripts like binaries and take care!

----------------------------------------------------------------------

QUICK-START

Input / controls:
if you have a joystick, it acts like a gamepad
no joystick/gamepad => keyboard acts like a gamepad

Keyboard controls:

Key		Function		Comments

ESC		quit
Alt+Enter	toggle fullscreen	(not supported on win32)
Ctrl+Z		iconify window		(not supported on win32?)

Keypad 1:
cursor keys _on the number block_
buttons: 0 and . (, on german keyboards)

Keypad 2:
w,a,s,d
buttons: 1 and 2

For best results please make sure your video driver synchronizes page
flips to the vertical retrace of your monitor.

(if you use linux and nvidia drivers:
export __GL_SYNC_TO_VBLANK=1
with version 1.0-5336 it seems to works well
older versions used a busy loop)

Windows:
All .bat files should do something.

To run a local 2-player pong game start:
pong.bat

To run a networked 2-player pong game:
first start
netpong.bat (this starts the server)
then
client.bat (this starts the client)

Linux users:
USAGE: egachine script

----------------------------------------------------------------------

FEATURES/GOALS:

- not limited to games - could also be used as:
  presentation tool,
  "movie" player similar to flash,
  special purpose terminal,
  tool to teach/learn OpenGL

- beginner friendly:
  Get  beginners started with  game  programing. For  now  there is no
  detailed documentation (any volunteers?) but the examples should get
  you started.  JavaScript is a nice  language  and you don't  need to
  compile  code.  You only  need  EGachine and  a   text editor to get
  started.

- audio support:
  Currently the audio API is very basic but simple:
  you can play music and samples. In the future there probably will be
  OpenAL bindings.

- optional OpenGL <http://www.opengl.org> support:
  for the advanced programmer or OpenGL teaching - OpenGL language 
  bindings are included. The API is close to the C API. Instead of 
  glBegin write gl.Begin and glGet(3x) functions return an array.

- quick development of games
  sometimes you just want to write a game within few hours

- portability

- Run untrusted code in a secure manner:
  This is similar to Java applets or like browsers run JavaScript 
  code. This means you only download the client once and games/apps
  may be shipped via network. Neither server nor client can access 
  files from JavaScript code.

- network support:
  Writing multi-player network games/apps should be easy.
  The client may establish one connection to a server. The server may 
  listen on one port and establish one connection (for example to a 
  meta-server).

----------------------------------------------------------------------

ROADMAP:

1.0.0 (May 2004):
	- feature complete stable API with documentation
	- not yet suitable for running untrusted code

1.2.0 (End of 2004):
	- suitable for running untrusted code
	- optional GUI toolkit
	- useful demo
	- downwards compatible

----------------------------------------------------------------------

HELP WANTED:

if you like EGachine please contact me/us. For now mail me directly:
karme@berlios.de

Could someone write a small GUI in JavaScript?
(Menu, checkboxes, themable, suitable for games)

Perhaps a game generator frontend which produces suitable output for
egaserver/egachine ?

As you probably noticed I am  no native English  speaker and for me it
is quite  difficult to write texts and  documentation. Perhaps you are
a good writer?

----------------------------------------------------------------------

Compilation from source:
currently no Makefile, no autoutils (no autoconf/make)
only a bash script (someone wants to make it a sh-script?)
I recommend to use ccache or compilercache.

Dependencies:
SDL
SDL_image
SDL_mixer
OpenGL/Mesa
c++ (f.e. gcc - probably version >=3)

For regenerating OpenGL wrappers (normally not needed):
perl,sed,grep,indent,bash,?

take a look at ./make - perhaps you have to edit something?

If you checked out from CVS you also need spidermonkey which is not in
CVS but in the source tarball.

----------------------------------------------------------------------

Spidermonkey/JavaScript/xxx wrapping:

There are (at least) three different approaches to wrapping native
code.
Related news posts/threads on netscape.public.mozilla.jseng:
<brt6ur$le31@ripley.netscape.com>
<00rr3c.vo1.ln@karme.myfqdn.de>
<mailman.1065540724.990.clpa-moderators@python.org> (python wrapper)

1) Only use some macros (currently we use this)
Advantages:
+ simple 
+ someone new to the code should be able to understand it quickly
+ low compiler requirements
+ fast compilation
+ works with plain C
+ minimalistic (runtime/code) overhead
Disadvantages:
- needs quite some hand-crafted code (time consuming)
- error phrone
- not very stylish / ugly code / perhaps hard to debug
- changes can't be made at a central point
  (code duplication)

Projects using this aproach:
JSDB <http://www.jsdb.org>

2) Use a code generator
Advantages:
+ generated code should still be simple to understand
+ works with plain C
+ less error phrone
+ changes can be made at a central point
Disadvantages:
- code generator parsers are often not perfect
- another step in the build process

Related projects:
* jsgen <http://www.cs.unm.edu/~cello/jsgen/>
* swig <http://swig.sourceforge.net/>
  (spidermonkey support not yet ready?)

3) Use C++ template magic to automate the wrapping

Advantages:
+ less error phrone
+ no additional step in the build process
+ probably nicer code
+ changes can be made at a central point
Disadvantages:
- slow compilation
- high compiler requirements
- steeper learning curve
- probably overhead (code size/runtime)

Clipp <http://clipp.sourceforge.net>
http://195.137.84.121/Warrick/Geek/SpiderMonkey/index.htm
http://cvs.sourceforge.net/viewcvs.py/boost/boost/boost/langbinding/\
?only_with_tag=langbinding
Boost::python

----------------------------------------------------------------------

Links:

http://mozilla.org/js/spidermonkey/
http://www.libsdl.org
http://www.opengl.org
http://www.mesa3d.org
http://torcs.sf.net
http://jsdoc.sf.net

----------------------------------------------------------------------

Similar projects:

Sphere <http://sphere.sourceforge.net/>:
  License: GPL
  Description: Ever had that perfect  plot idea for  an RPG but didn't
  have the programming knowledge to create it? Enter Sphere. Sphere is
  a  console-style RPG  engine  that  allows  others to  create an RPG
  similar  to Final Fantasy, Dragon Quest, or Phantasy Star.

----------------------------------------------------------------------
