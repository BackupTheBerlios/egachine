#!/bin/bash
../src/ejs <<EOF

var EGachine=ejs.ModuleLoader.get("EGachine");
var Video=ejs.ModuleLoader.get("Video");
var gl=ejs.ModuleLoader.get("gl");
var Timer=ejs.ModuleLoader.get("Timer");
var stderr=ejs.ModuleLoader.get("Stream").stderr;

if (!gl.GetIntegerv(GL_STENCIL_BITS)[0])
	stderr.write("Warning no stencil buffer\n");

ejs.ModuleLoader.load("svgl");
function debug(x){stderr.write(x+"\n");}

function test(svgdoc){
  svgl.selectDocument(svgdoc);
  var i=0,start=Timer.getTimeStamp(),dt=0;
  while((dt=(Timer.getTimeStamp()-start))<2000000) {
    gl.Clear(GL_COLOR_BUFFER_BIT|GL_STENCIL_BUFFER_BIT);
    svgl.display();
    Video.swapBuffers();
    ++i;
  }
  debug("fps: "+i*1000000/dt+" dt:"+dt);
}

addResources();
svgdoc=new svgl.SVGDocument(EGachine.getResource("lion.svg").decode());
test(svgdoc);

function addResources(){
EGachine.addResource(
({name:"lion.svg", size:21195, z:true, data:"\
eJylXFuvLMdVfrfEfxgOr5Ocul8ixxEkEUJCEIUA4jGxHcfSwY6SAyb/nu+yZk+3BdORsh9m7equrlu\
vWpdvrepPf/I///nh9t9f/uGPX3/7ze3Ht3f5h+nd7Y8ff/3NF7/+8O03X/LSN9+++8lnn3z61z/755\
/+6j9+8fPbH//7q9sv/vXv/vEffnp794P37/+9/vT9+5/96me3f/m3v7+VhL+Vyvv3P/+nd7dPbrd3v\
/v48fc/ev/+u+++++F39Yff/uGr97/65XtWe//TX/4Aj/zg7RG08R5tv1344Rcfv3j32SeffMoOv/v6\
i4+/42hawgB/9+XXX/3u449VYI2PX3/88OVnf3v7/L8+fnn7gKl88ul7X/vk068wnT99+PLH73779Yc\
PP/qb35bPP9/73e0zju726e+//fCnD19jor//9utvPv6RPdzGvud1W+W+bnvf6y3nde+3XPs9l1tu+1\
7yLfdxz7g1+n3f8pwqrHovCyTde8Ktdt+siMfSBG33nBtoRjO43khxvaK3OlSvJNJ5Lx33y7jXhv5qv\
deOemXd6xw39EEy+72OdRsTN9NtZJGOe2Pfmn4LfvMN1To6LW4LTaLrhg4mf1u7oTPMFUOYeGJoRK3e\
d73Vcp/zVtN9pltp9zH5dONc0SLmeC+Vd7EiDXXY9byNwrKX7/D77j0W+9P3X/H3e2/jy/6bMn/78m3\
khpGg3zruEzOp6768KnOJLE5vqoQlWhgbhruw/qXfF0adtx4A2b64t8nQAzkl0c22832z0cIF4PveU/\
2qtFzaqtlck0vFUlO/MdAjeTX13yxw+eupY145ZY1I46xTo0d/uozucwrOzOlZ/UxfjOHP2Ax54lWXb\
b5sSytQtHbkz60x1U6+XeZTMih4rZDnKigGV9YyBUMWrHXpvl+4TdYyvz/6OdMXg9+frzJ+83Lw2KRs\
q6GplkW4SzCRlW8D4yz9NrF1KnY7SEbJO2Ri2+esvYZ15F5LqJIw8XWbvFhZk8uAx3URu2mL9QuYhSW\
wJWcAtmSV6Spg4MGLqILGuH/RCrYWL2JtBi8ObqPS9w2ipfSq4fZ161vLRCmBDU2Cl8EHKjYf9zImxk\
3ZVIJAibmfiFbz/1usSblRNffhBSGhnCm3tXVv451CHmysEuYA3gLF3kpLsgY8iDJp9X3KG5YLrnfuz\
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\
wG+ty5w\
"}));
};
EOF
